### 动画

#### 顺序动画和融合动画

融合动画：cc.Spawn:create()

顺序动画：cc.Sequence:create()

```lua
local bazier=cc.MoveTo
local sequence=cc.Sequence:create(cc.Spawn:create(bazier,rotate),cc.CallFunc:create(callFunc),nil)
```

#### 动画

##### 1.贝塞尔曲线

```lua
--获得一个贝塞尔曲线的Action
--@param posFrom 运动起点
--@param posTo 运动结束点
--@param time 运动的持续时间
--@return Action
function GameArea:bezier(posFrom,posTo,duration)
    
    local posMid = self:getMidPoint(posFrom,posTo,duration)
    local points = {posFrom,posMid,posTo}
    local action = cc.BezierTo:create(duration,points)
    return action
end

--此方法是将y轴抬高，返回两个点的中间坐标
--@param posFrom 运动起点
--@param posTo 运动结束点
--@param time 运动的持续时间
--@return 返回贝塞尔曲线的中间坐标
function GameArea:getMidPoint(posFrom,posTo,time)
    local y = posFrom.y
    if posTo.y > y then 
        y = posTo.y
    end 
    local y = y * 3 /2
    local posRet = cc.p((posFrom.x + posTo.x) / 2,y)
    return posRet
end

--获得整个进行贝塞尔曲线的时间，时间的计算方式是两点的距离*速度
--@param posFrom 运动起点
--@param posTo 运动结束点
--@return 返回float类型的时间
function GameArea:getDropTime(posFrom,posTo,speed)
    local time = 10
    local distance = (posFrom.x - posTo.x) * (posFrom.x - posTo.x) + (posFrom.y - posTo.y) * (posFrom.y - posTo.y)
    if distance < 0 then
        distance = -distance
    end
    distance = math.sqrt(distance)
    time = distance*speed
    return time
end
```

##### 2.旋转

```lua
local rotate= cc.RotateTo:create(duration, 30)
```

##### 移动

```lua
local move= cc.MoveTo:create(duration,cc.p(0,9))
```
##### EaseSineInOut

```lua
local girlAction= cc.EaseSineInOut:create(cc.MoveTo:create(2,cc.p(imageGirl:getPositionX(),imageGirl:getPositionY()+4)))
local girlBackAction = cc.EaseSineInOut:create(cc.MoveTo:create(2,cc.p(imageGirl:getPositionX(),imageGirl:getPositionY()-4)))
local temSeq = cc.Sequence:create(girlAction,girlBackAction)
imageGirl:runAction(cc.RepeatForever:create(temSeq))
```

### 帧动画

##### 根据图片生成帧动画

```lua
CharmAction.charmActIndex = {
    [10301] = 7,
    [10302] = 5,
    [10309] = 8,
    [10303] = 5,
    [10307] = 7,
    [10310] = 8
}
resConfig.ACT_CHARM_N         = "GameCommon/GameCharm/imge/charm_act_%d_%d.png"
function CharmAction:getCharmAct(index)
    local animation = cc.Animation:create()
    for  i = 0,self.charmActIndex[index]-1 do
        local szName = string.format(resConfig.ACT_CHARM_N,index,i)
    	animation:addSpriteFrame(cc.SpriteFrameCache:getInstance():getSpriteFrame(szName))
    end
    animation:setDelayPerUnit(3.0 / 14)
    animation:setRestoreOriginalFrame(true)
    local action = cc.Animate:create(animation)
    return action
end
```
##### 根据csb对象播放动画

```lua
function play2DAnimation(position)
    local animationNode=cc.CSLoader:createNodeWithVisibleSize("")
    local animation = cc.CSLoader:createTimeline("")
    if animation and animationNode then
        animationNode:runAction(animation)
        animation:gotoFrameAndPlay(0,false)
    end
end

--在我们的平常需求中，我们不仅仅播放动画，更需要多个动画融合使用。比如动画播到指定帧后，执行一个另外一个动画或方法。通过Sequence顺序或Spawn同步执行动画。原理是将csb动画拆分成几个动画，在这几个动画中插入其他的动画或者是方法，期间需要使用delay函数延迟执行。
-- 播放2D闪电动画
-- @parent 父节点
-- @position 位置坐标 屏幕坐标
function HuDanFangMah:play2DAnimation(parent,position)
    local animationNode=cc.CSLoader:createNodeWithVisibleSize(m3D.MahSourcePath.huAnimationNodePath)
    if animationNode then
        local animation = cc.CSLoader:createTimeline(m3D.MahSourcePath.huAnimationNodePath)
        --动画1 播放闪电动画
        local animationFunc=cc.CallFunc:create(function ()
            animation:gotoFrameAndPlay(0,false)
            animationNode:runAction(animation)
        end)
        --动画2 delay n秒
        local delayFrame=animation:getDuration()
        local delayTime=delayFrame*cc.Director:getInstance():getAnimationInterval()
        local delay= cc.DelayTime:create(delayTime)
        --动画3 销毁闪电节点
        local callFunc=cc.CallFunc:create(function ()
            animationNode:removeFromParent()
            animationNode:setVisible(false)
        end)
        --播放动画
        animationNode:runAction(cc.Sequence:create(animationFunc,delay,callFunc))
        parent:addChild(animationNode)
        animationNode:setPosition(position)
    end
end
```

